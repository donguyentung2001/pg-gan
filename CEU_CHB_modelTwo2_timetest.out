2021-08-02 19:55:56.963567: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-08-02 19:55:56.987300: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_COMPAT_NOT_SUPPORTED_ON_DEVICE: forward compatibility was attempted on non supported HW
2021-08-02 19:55:56.987324: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: walnut
2021-08-02 19:55:56.987328: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: walnut
2021-08-02 19:55:56.987386: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 460.91.3
2021-08-02 19:55:56.987402: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 460.80.0
2021-08-02 19:55:56.987407: E tensorflow/stream_executor/cuda/cuda_diagnostics.cc:313] kernel version 460.80.0 does not match DSO version 460.91.3 -- cannot find working devices in this configuration
2021-08-02 19:55:56.987590: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2021-08-02 19:55:56.991380: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3000000000 Hz
2021-08-02 19:55:56.991612: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6e14000b60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-08-02 19:55:56.991643: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
NUM_ITER 1
BATCH_SIZE 50
NUM_BATCH 100
NUM_SNPS 36
L 50000
NUM_CLASSES 2
NUM_CHANNELS 2
NUM_ITER 1
BATCH_SIZE 50
NUM_BATCH 100
NUM_SNPS 36
L 50000
NUM_CLASSES 2
NUM_CHANNELS 2
{'model': 'post_ooa', 'params': 'N_anc,N1,N2,N3,T1,T2,mig', 'data_h5': '/bigdata/smathieson/pg-gan/1000g/HDF5/CEU_CHB.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.h5', 'bed': '/bigdata/smathieson/pg-gan/1000g/HDF5/20120824_strict_mask.bed', 'reco_folder': '/bigdata/smathieson/pg-gan/1000g/genetic_map/', 'grid': None, 'toy': None, 'seed': 1833}
N_anc,N1,N2,N3,T1,T2,mig
[<util.Parameter object at 0x7f6f22023e10>, <util.Parameter object at 0x7f6f2201c110>, <util.Parameter object at 0x7f6f2213bf90>, <util.Parameter object at 0x7f6f2213be10>, <util.Parameter object at 0x7f6f2213bdd0>, <util.Parameter object at 0x7f6f22344450>, <util.Parameter object at 0x7f6f22344490>]
['N_anc', 'N1', 'N2', 'N3', 'T1', 'T2', 'mig']
NAME	VALUE	MIN	MAX
N_anc	15000	1000	25000
NAME	VALUE	MIN	MAX
mig	0.05	-0.2	0.2
NAME	VALUE	MIN	MAX
N1	9000	1000	30000
NAME	VALUE	MIN	MAX
N2	5000	1000	30000
NAME	VALUE	MIN	MAX
N3	12000	1000	30000
NAME	VALUE	MIN	MAX
T1	2000	1500	5000
NAME	VALUE	MIN	MAX
T2	350	100	1500
['calldata', 'variants']
['GT'] ['CHROM', 'POS']
raw (13867561, 98, 2)
after haps (13867561, 196)
Parsing HapMap recombination rates...
parameters <class 'list'> [<util.Parameter object at 0x7f6f22023e10>, <util.Parameter object at 0x7f6f2201c110>, <util.Parameter object at 0x7f6f2213bf90>, <util.Parameter object at 0x7f6f2213be10>, <util.Parameter object at 0x7f6f2213bdd0>, <util.Parameter object at 0x7f6f22344450>, <util.Parameter object at 0x7f6f22344490>]
Model: "two_pop_model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 98, 32, 32)        352       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 98, 12, 64)        10304     
_________________________________________________________________
max_pooling2d (MaxPooling2D) multiple                  0         
_________________________________________________________________
flatten (Flatten)            (None, 384)               0         
_________________________________________________________________
concatenate (Concatenate)    (None, 768)               0         
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense (Dense)                (None, 128)               98432     
_________________________________________________________________
dense_1 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_2 (Dense)              (None, 4)                 516       
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 5         
=================================================================
Total params: 126,121
Trainable params: 126,121
Non-trainable params: 0
_________________________________________________________________
pretraining starts
at iteration  1
Epoch 20, Loss: 0.8268483877182007
Epoch 40, Loss: 0.8226654529571533
Epoch 60, Loss: 0.8187494277954102
Epoch 80, Loss: 0.8119615316390991
Epoch 100, Loss: 0.7962610125541687
The number of layers in encoder is  9
The number of layers in discriminator is  10
changing discriminator's weights in layer  0
changing discriminator's weights in layer  1
changing discriminator's weights in layer  2
changing discriminator's weights in layer  3
changing discriminator's weights in layer  4
changing discriminator's weights in layer  5
changing discriminator's weights in layer  6
changing discriminator's weights in layer  7
changing discriminator's weights in layer  8
pretraining weights are: 
[array([[ 0.21201673,  0.16076238,  0.07019147,  0.15124422],
       [ 0.13408619, -0.06848571, -0.10520813, -0.04285632],
       [-0.01930715, -0.18141393, -0.18739146,  0.09245728],
       [-0.20915045, -0.03045124,  0.15643972,  0.1527175 ],
       [-0.14799483,  0.01352877, -0.02746508,  0.00894641],
       [ 0.01081051,  0.00304587,  0.07198006,  0.01279926],
       [-0.1707293 , -0.15005136, -0.02318328, -0.13028713],
       [ 0.19227344, -0.08186619,  0.10739246, -0.06820165],
       [ 0.11152816, -0.18845516,  0.17272377,  0.18939519],
       [ 0.10339153,  0.03451665, -0.1707244 , -0.18521102],
       [-0.03444931, -0.06094771,  0.18902798,  0.00095709],
       [-0.12812114,  0.16261259, -0.18204695,  0.2088933 ],
       [ 0.01643112,  0.18612376, -0.21002719,  0.20131108],
       [ 0.07959785, -0.18986642, -0.05697021, -0.04748921],
       [-0.05327592,  0.08290584,  0.18438232,  0.09073885],
       [ 0.21103907,  0.07589011, -0.02893745, -0.19271262],
       [ 0.02292529, -0.04014526, -0.17561628,  0.19617638],
       [ 0.18639517,  0.20784499,  0.1479058 , -0.0089906 ],
       [ 0.03856822,  0.048004  ,  0.11644226, -0.11831699],
       [ 0.19883162, -0.15811643,  0.15063056,  0.18225098],
       [ 0.15971908,  0.01038073,  0.03372894, -0.17906512],
       [ 0.17194234, -0.15298246,  0.16368549, -0.03895679],
       [ 0.14797457, -0.06868212, -0.18355086, -0.20758595],
       [ 0.07636853, -0.03165879,  0.10528953,  0.10564441],
       [-0.06225251,  0.1324788 , -0.01246188,  0.05715965],
       [-0.20956463,  0.08907327, -0.20232221, -0.19071643],
       [ 0.07412158, -0.06361526,  0.03671071,  0.15202683],
       [-0.02931998,  0.07476919,  0.02793146, -0.09103956],
       [ 0.14217296, -0.01708628,  0.21230745,  0.21089035],
       [-0.09217799, -0.12183677,  0.02992817, -0.13672116],
       [-0.18165138, -0.02675968,  0.16672271, -0.11225505],
       [ 0.18237598, -0.05794036,  0.06340545,  0.06984121],
       [-0.19865876,  0.14057428, -0.05881174, -0.12593575],
       [-0.17469676, -0.05329286,  0.03195481, -0.00309911],
       [-0.06151469, -0.17057389,  0.06418888, -0.2071547 ],
       [-0.04485712,  0.10828086, -0.01960856,  0.14837362],
       [ 0.19315192,  0.11619878, -0.11602703,  0.10741196],
       [-0.16323993, -0.13381885,  0.08861046,  0.07022896],
       [-0.14710037, -0.16105461,  0.08674151,  0.04062319],
       [ 0.14789018, -0.15826556, -0.08661422,  0.13482505],
       [-0.01495873,  0.13435076, -0.15227863, -0.13723098],
       [ 0.07115788,  0.14067192, -0.05063339,  0.11904142],
       [-0.18490808,  0.19052613,  0.18686193,  0.01587915],
       [-0.19488737,  0.06737462, -0.12342029,  0.15695217],
       [ 0.0988861 ,  0.11604038,  0.03213419,  0.12636128],
       [ 0.10993919, -0.10505759,  0.07419544, -0.10388242],
       [ 0.01931782,  0.13566852,  0.04349646, -0.13423428],
       [ 0.04677165, -0.17532313,  0.19369335, -0.05694259],
       [-0.19272883,  0.12380794, -0.14767434, -0.15696427],
       [-0.11091254,  0.16656765,  0.06031366, -0.0884068 ],
       [ 0.12181896,  0.05867594, -0.1363688 ,  0.06460106],
       [ 0.12236362, -0.05362978,  0.11941192,  0.09641664],
       [-0.19753474, -0.13314533, -0.11938392,  0.15933466],
       [-0.13711706,  0.01190184,  0.10625292, -0.16382386],
       [ 0.05661146,  0.20611443,  0.0926459 ,  0.19583593],
       [-0.03512071,  0.18534659, -0.14687227, -0.10200523],
       [ 0.00294418,  0.02516994,  0.19746791,  0.08810742],
       [ 0.11438833, -0.1647521 ,  0.06304909, -0.15466255],
       [ 0.04092893,  0.17050913, -0.05925514,  0.00189574],
       [-0.05898433, -0.04135613, -0.16194803,  0.1058728 ],
       [-0.0941616 , -0.18544072, -0.11306247,  0.04444534],
       [ 0.09781742, -0.18772364, -0.16339062,  0.11851785],
       [-0.09944687,  0.07902526,  0.14339678, -0.0616087 ],
       [-0.07757039,  0.03528383, -0.10773483,  0.15529281],
       [ 0.13990767,  0.03487287,  0.01324677,  0.07380714],
       [-0.1418179 , -0.03202166,  0.16116095, -0.20545973],
       [ 0.16878444, -0.09693759, -0.12104654,  0.13541234],
       [-0.06367573, -0.1643777 , -0.1112129 , -0.04491558],
       [ 0.06564643, -0.01621932,  0.00638372,  0.06423647],
       [ 0.01686019,  0.1501838 , -0.11631335, -0.15447189],
       [-0.17134427, -0.15208444, -0.11593379,  0.1348453 ],
       [-0.0411607 , -0.11832676,  0.07530027, -0.19409384],
       [-0.08122954,  0.20520607, -0.04403989, -0.03453006],
       [-0.04939972,  0.08886424,  0.03933081, -0.0174907 ],
       [-0.07000835,  0.03326687, -0.13285026,  0.06614099],
       [ 0.04549776,  0.03028538, -0.13742885,  0.08494614],
       [ 0.08554932,  0.14730711,  0.15339917,  0.05626168],
       [ 0.21051969,  0.10928611,  0.00929505,  0.01685775],
       [ 0.1880418 ,  0.0024237 , -0.11743952,  0.09548805],
       [ 0.09105207,  0.16939484, -0.21139838,  0.10387764],
       [ 0.05236387,  0.02939801, -0.01240248,  0.02188491],
       [-0.1529823 ,  0.18447623, -0.19101354,  0.0565559 ],
       [ 0.09919534,  0.16898112, -0.19944535,  0.10397014],
       [ 0.09357654,  0.07316371,  0.01307052, -0.09013714],
       [ 0.07113272, -0.12709731, -0.12615865, -0.1083154 ],
       [-0.00615959,  0.02055891, -0.18628806, -0.03810094],
       [-0.03199241,  0.14000382, -0.11634678,  0.15425053],
       [ 0.17642349, -0.1110145 , -0.14449315, -0.20130864],
       [-0.07883327,  0.19627741, -0.15432331, -0.19514859],
       [ 0.12602781,  0.09507891,  0.08228609,  0.20751722],
       [ 0.06073907,  0.01860776,  0.17663519, -0.18000379],
       [-0.15520315, -0.21054201,  0.15734003,  0.07750978],
       [-0.15486014, -0.06823581, -0.07445826,  0.10017766],
       [ 0.20382327,  0.18220091, -0.13639817, -0.03637294],
       [-0.07273383,  0.05296964,  0.10287362,  0.02915567],
       [-0.02879989, -0.08071426,  0.04367432, -0.16752265],
       [-0.04614251,  0.18178684, -0.13340846, -0.14899652],
       [-0.20096122,  0.05426115, -0.21145615,  0.16112104],
       [-0.19646674,  0.09879699, -0.09740139, -0.0008392 ],
       [ 0.07559198, -0.07354657, -0.20318776, -0.11152238],
       [ 0.15334353,  0.10405555,  0.10483661, -0.01040247],
       [ 0.03916051, -0.19933629, -0.17559755, -0.09837633],
       [-0.06772888,  0.10166721,  0.18452016, -0.01304481],
       [-0.08238351, -0.07291208, -0.19016081,  0.07897338],
       [-0.18073185,  0.08817026, -0.20325425, -0.11981459],
       [ 0.0999725 , -0.09278976,  0.07342917,  0.07033511],
       [ 0.1282024 , -0.08448673, -0.13708313,  0.01256264],
       [-0.01406611,  0.19607191,  0.04801292,  0.12726946],
       [-0.1606986 , -0.01140984,  0.07116103,  0.01161502],
       [ 0.14793108,  0.14274101,  0.0067275 , -0.14295618],
       [-0.01571456, -0.17994492,  0.031202  , -0.09839986],
       [ 0.17055655,  0.04976076, -0.13534702,  0.07909128],
       [ 0.06268439, -0.12010103,  0.04677179, -0.03319423],
       [ 0.14569089, -0.06221344,  0.15821998, -0.17996164],
       [-0.09719194, -0.20024595,  0.11922593,  0.18974598],
       [ 0.19937566,  0.13058919,  0.06207721,  0.07234748],
       [-0.10330095, -0.1589407 ,  0.13710545, -0.12619957],
       [-0.2067125 , -0.08191139,  0.03429823,  0.12192371],
       [-0.0096889 , -0.07910866,  0.09912101,  0.15452176],
       [-0.09318921, -0.15921122,  0.16757078,  0.01989279],
       [ 0.00767947,  0.18755192, -0.08022802,  0.19387177],
       [-0.10324886, -0.08848654, -0.19108766, -0.10707648],
       [ 0.03694759,  0.2001069 ,  0.05873125,  0.20815252],
       [-0.06028584,  0.01534924,  0.18726271,  0.19998613],
       [ 0.08519524, -0.17407334, -0.1155158 ,  0.05717913],
       [ 0.18617944,  0.04224763,  0.10115226, -0.12496789],
       [-0.02990364, -0.00115025, -0.19239771,  0.12157813],
       [-0.11372521, -0.00475124, -0.12121424, -0.00530998]],
      dtype=float32), array([-0.00019735,  0.00034557,  0.00049459, -0.00061969], dtype=float32)]
finish pretraining with VAE. The discriminator layers should now be updated. 
 Now we find the best parameters for the discriminators. 
Finding most influential nodes in layer  8
<tensorflow.python.keras.layers.core.Dense object at 0x7f6e4f6a6e10>
Finding most influential nodes in layer  7
<tensorflow.python.keras.layers.core.Dense object at 0x7f6e4f6a6990>
Finding most influential nodes in layer  6
<tensorflow.python.keras.layers.core.Dense object at 0x7f6e4f6a6510>
768
{8: (0, array([0.21201673, 0.16076238, 0.07019147, 0.15124422], dtype=float32)), 7: (127, array([ 1.52052864e-01,  3.17964368e-02,  1.06629200e-01,  4.99373674e-02,
       -1.40315890e-01, -1.36822611e-01,  1.11018151e-01, -1.51115865e-01,
       -7.81193376e-03, -1.41585797e-01, -1.26287609e-01, -1.39315620e-01,
        1.09483823e-01, -2.73163877e-02, -4.88944687e-02, -1.54343573e-02,
       -1.43467551e-02,  2.10181400e-02, -1.04319587e-01,  1.24060713e-01,
       -1.47829935e-01,  6.55333549e-02,  1.41259432e-01, -1.39631599e-01,
       -1.22622987e-02,  8.47290009e-02, -4.04256210e-02,  1.33114919e-01,
       -1.39221013e-01, -6.27618805e-02, -2.80567557e-02,  9.33415890e-02,
       -5.87256923e-02, -2.48432858e-03,  1.09113149e-01, -9.72354859e-02,
        8.40506479e-02, -1.47056058e-01, -8.04256201e-02, -3.34390402e-02,
       -1.04656249e-01,  1.42015237e-02, -9.80815142e-02,  6.79740012e-02,
        2.13636607e-02,  2.63909847e-02, -1.28368646e-01, -9.78929177e-02,
        4.70905825e-02, -4.27420884e-02, -1.44241333e-01, -1.35969117e-01,
       -1.20618120e-01, -1.29145175e-01, -1.05725355e-01,  6.20900653e-02,
        3.32415197e-03, -6.18987232e-02, -9.70593244e-02,  6.45626113e-02,
        1.41659051e-01, -1.48168221e-01, -5.93779087e-02,  2.51009536e-04,
        1.48381233e-01, -5.27903102e-02,  3.75649333e-03,  1.19958259e-01,
       -1.22481316e-01,  5.66688925e-02, -1.50187239e-01, -6.38770014e-02,
       -1.44045904e-01,  1.50784701e-02,  3.11861169e-02,  5.79539426e-02,
        6.35530129e-02, -1.06928192e-01, -1.29894251e-02,  6.52578175e-02,
       -1.51008010e-01, -1.19683146e-02, -3.25195119e-02, -6.95909793e-03,
       -1.48837119e-01,  8.33905414e-02, -9.92039666e-02, -4.79693599e-02,
        9.95809969e-05, -9.76689532e-03,  7.00649396e-02,  2.94247698e-02,
        1.50692806e-01, -1.13541126e-01, -1.21262051e-01, -7.71797597e-02,
       -1.30905375e-01, -1.80643648e-02,  7.20099434e-02,  7.95594305e-02,
        5.85717261e-02,  1.21055283e-01, -5.89912906e-02,  9.42672119e-02,
       -1.06080949e-01, -6.99547306e-02, -2.64001768e-02, -1.22079231e-01,
       -5.92247769e-02,  1.09976210e-01, -1.11150846e-01,  1.52412489e-01,
       -4.18929681e-02, -7.05517083e-02, -4.68875002e-03, -4.80908807e-03,
        6.45930693e-02, -6.36710227e-03, -3.72587517e-03, -1.65083818e-02,
       -1.47596270e-01,  3.67729366e-02, -6.64728284e-02, -1.19428724e-01,
       -1.04853347e-01, -4.73001227e-02, -4.30979207e-02,  1.25651911e-01],
      dtype=float32)), 6: (53, array([ 0.03942101, -0.03869319,  0.00412112, -0.06025154,  0.06316365,
        0.01878714,  0.05978661,  0.04496527, -0.05071177, -0.05184157,
       -0.0555708 , -0.06644332, -0.04902653,  0.02462933, -0.00455911,
       -0.0227023 ,  0.06781477,  0.08022708, -0.04094159, -0.03251199,
       -0.07493105, -0.00062898,  0.03975162,  0.05313345, -0.02967754,
        0.0750251 ,  0.0768526 ,  0.0738502 , -0.02745383, -0.00850909,
        0.04846196, -0.03932146, -0.01486802, -0.02475629, -0.08107796,
        0.04156183, -0.04586279,  0.06087776, -0.0572288 , -0.07152398,
       -0.06440395, -0.03907905,  0.03119542,  0.01571869, -0.05852352,
        0.02218833,  0.01873982,  0.00240079, -0.01592415,  0.00788444,
        0.01912052, -0.04501647,  0.00421506, -0.05977447,  0.00758185,
       -0.0653764 ,  0.07089839,  0.00270583, -0.06304516, -0.05516217,
       -0.02334871,  0.04260092, -0.02835494, -0.02105547, -0.07406444,
        0.06200247, -0.04593639,  0.02952024,  0.02893738, -0.01799213,
        0.00392979,  0.00814357, -0.01146876,  0.03201316,  0.01250576,
       -0.00639307,  0.01468359,  0.05673695, -0.01962058,  0.0760287 ,
       -0.05229868,  0.06956257, -0.0502445 ,  0.04244877, -0.07584237,
        0.03433709,  0.06280885, -0.0043433 ,  0.00930213, -0.07977805,
        0.05263561, -0.03052495,  0.06857266, -0.00825131,  0.0385275 ,
        0.00628975,  0.05965845,  0.03890433, -0.00402258, -0.00713246,
       -0.00191912,  0.07405908,  0.03660258, -0.05587808,  0.07108158,
       -0.00321271, -0.0758417 ,  0.0170023 ,  0.08096457,  0.02277408,
        0.01992774, -0.00690836, -0.00661116,  0.07794257, -0.05165557,
        0.03278451, -0.07742929,  0.02085485, -0.05497996,  0.06727575,
       -0.01103306, -0.02842378, -0.02279967,  0.05034743, -0.00263958,
       -0.00858962,  0.04959176, -0.08257771], dtype=float32))}
trial 1 [18014.237028449494, -0.13246700584043308, 18816.541861125675, 19937.70087694249, 1614.4605003581084, 3978.937067276148, 402.56995585913023]
Accuracy now is 0.23850000000000002
New max accuracy is 0.23850000000000002
trial 2 [21048.846818849506, 0.1259144461987759, 5219.220893510952, 10799.76668005129, 3327.1475323182244, 4793.965045810971, 799.6730980183224]
Accuracy now is 0.2429
New max accuracy is 0.2429
trial 3 [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124]
Accuracy now is 0.24760000000000001
New max accuracy is 0.24760000000000001
trial 4 [20609.25104724058, -0.03783840016756129, 16586.264592420433, 22352.880538480826, 21417.92890164554, 4885.76381912851, 501.1820527151722]
Accuracy now is 0.2463
trial 5 [21713.60990098057, 0.07740729632811277, 1399.8791745950855, 1725.3154304935706, 1986.357959264185, 4721.152112083136, 483.1206261062307]
NOT ENOUGH SNPS 28
28 36 14 18
NOT ENOUGH SNPS 29
29 36 14 18
NOT ENOUGH SNPS 29
29 36 14 18
NOT ENOUGH SNPS 28
28 36 14 18
NOT ENOUGH SNPS 28
28 36 14 18
NOT ENOUGH SNPS 27
27 36 13 18
NOT ENOUGH SNPS 30
30 36 15 18
NOT ENOUGH SNPS 31
31 36 15 18
NOT ENOUGH SNPS 35
35 36 17 18
NOT ENOUGH SNPS 26
26 36 13 18
NOT ENOUGH SNPS 27
27 36 13 18
NOT ENOUGH SNPS 16
16 36 8 18
NOT ENOUGH SNPS 28
28 36 14 18
NOT ENOUGH SNPS 26
26 36 13 18
NOT ENOUGH SNPS 29
29 36 14 18
NOT ENOUGH SNPS 26
26 36 13 18
NOT ENOUGH SNPS 30
30 36 15 18
NOT ENOUGH SNPS 27
27 36 13 18
NOT ENOUGH SNPS 20
20 36 10 18
Accuracy now is 0.2454
trial 6 [5792.100093854645, 0.06565129945897247, 6047.095161305425, 12689.54898766522, 17091.00106632355, 4854.220868986081, 154.15686526573566]
Accuracy now is 0.24559999999999998
trial 7 [20346.551022566233, -0.015340906565281365, 17485.408520328798, 18662.126456243157, 26416.47380161213, 3003.8633662483844, 393.4241285328527]
Accuracy now is 0.2455
trial 8 [12945.044899220973, 0.016078708661755453, 7840.934627914462, 3308.792189871676, 25253.151305668453, 1693.2272006426142, 211.87021666719974]
Accuracy now is 0.2402
trial 9 [22812.42099743167, -0.09890517866084325, 9436.358908486956, 19924.842607809973, 6304.3400004470695, 2570.534831621165, 1496.7734789979702]
Accuracy now is 0.2405
trial 10 [15124.703829445649, -0.15635024205593906, 11756.075488497729, 17320.54991973094, 17369.84698779941, 2913.844044352896, 1201.5849507151552]
Accuracy now is 0.245
params, loss [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8106005

ITER 0
time 20:01:41.518278
0 proposal [21539.048080199333, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.88296944
1 proposal [20647.849440436403, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.754233
2 proposal [19490.48307331468, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.77979803
3 proposal [22829.60367750073, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.80139536
4 proposal [20186.46160145575, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.7410208
5 proposal [18794.12796351782, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.9015892
6 proposal [23906.494221352586, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8402134
7 proposal [23158.45561004647, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.79751015
8 proposal [20460.261374997914, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.7769871
9 proposal [21351.15257246224, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.74443865
0 proposal [20880.698616107995, -0.08361141735548155, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8597921
1 proposal [20880.698616107995, -0.079899803164614, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8419651
2 proposal [20880.698616107995, -0.11219931457355925, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8330281
3 proposal [20880.698616107995, -0.06337203069560637, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.9425465
4 proposal [20880.698616107995, -0.07793630692047457, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.91496116
5 proposal [20880.698616107995, -0.08391767571681756, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.890822
6 proposal [20880.698616107995, -0.15105075840736493, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.7796104
7 proposal [20880.698616107995, -0.038783565613517354, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.90110373
8 proposal [20880.698616107995, -0.0038714985696226695, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8823921
9 proposal [20880.698616107995, -0.054262252842899726, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.7238277
0 proposal [20880.698616107995, -0.06699029373674179, 27600.12649501887, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8937955
1 proposal [20880.698616107995, -0.06699029373674179, 24529.426146105496, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.82088745
2 proposal [20880.698616107995, -0.06699029373674179, 21823.32727484909, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.759698
3 proposal [20880.698616107995, -0.06699029373674179, 26581.217434302605, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.75295013
4 proposal [20880.698616107995, -0.06699029373674179, 23318.219069466784, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.9105475
5 proposal [20880.698616107995, -0.06699029373674179, 26056.429722828798, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.74155366
6 proposal [20880.698616107995, -0.06699029373674179, 28728.898270725265, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.739684
7 proposal [20880.698616107995, -0.06699029373674179, 24452.697141199744, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.77548087
8 proposal [20880.698616107995, -0.06699029373674179, 24911.081313817234, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.84434044
9 proposal [20880.698616107995, -0.06699029373674179, 23115.871444188764, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8637395
0 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 10692.284211236603, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8466337
1 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 10093.279294506057, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8082474
2 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 9508.318261614706, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8868008
3 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 10237.588008367858, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.85314703
4 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 11573.436935912552, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8970089
5 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 13301.856451056012, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.88735
6 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 13508.917645193917, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.78146833
7 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 16896.57119851978, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.8230388
8 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 13821.938613975499, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.79094213
9 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12883.840545661806, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.72600055
0 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12076.37377450262, 2216.116798093576, 1341.0223408700124] 0.7779716
1 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 10357.954575779027, 2216.116798093576, 1341.0223408700124] 0.75808054
2 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12420.138874824743, 2216.116798093576, 1341.0223408700124] 0.826288
3 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 13666.640662387066, 2216.116798093576, 1341.0223408700124] 0.9021018
4 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12681.499190104381, 2216.116798093576, 1341.0223408700124] 0.91941315
5 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 7290.876638897789, 2216.116798093576, 1341.0223408700124] 0.8886032
6 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 11313.328995696462, 2216.116798093576, 1341.0223408700124] 0.8901757
7 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12049.415352407, 2216.116798093576, 1341.0223408700124] 0.84509015
8 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 13190.712405809263, 2216.116798093576, 1341.0223408700124] 0.7457983
9 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12221.565507915775, 2216.116798093576, 1341.0223408700124] 0.76509637
0 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2169.5143285108315, 1341.0223408700124] 0.8465007
1 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2036.174758351057, 1341.0223408700124] 0.84035134
2 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2014.6514699469942, 1341.0223408700124] 0.8220308
3 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 1949.929295461444, 1341.0223408700124] 0.84992427
4 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2671.0260753232415, 1341.0223408700124] 0.84152025
5 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2023.958745844151, 1341.0223408700124] 0.9340973
6 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 1899.2305780004726, 1341.0223408700124] 0.91644174
7 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2304.3610203400112, 1341.0223408700124] 0.89719063
8 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2379.8595279474457, 1341.0223408700124] 0.78867096
9 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 1606.1575173426227, 1341.0223408700124] 0.90236
0 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1367.268327495184] 0.8344718
1 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1469.6674090336348] 0.83284295
2 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1440.528767870748] 0.8628458
3 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1328.411334582412] 0.84456235
4 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1254.637087989534] 0.8936448
5 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1323.9522927166265] 0.86596674
6 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1299.0174266515107] 0.7422203
7 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1356.9071096416626] 0.9268428
8 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1254.16209765688] 0.7318641
9 proposal [20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1300.7020421899333] 0.77587646
ACCEPTED
Epoch 100, Loss: 1.3377528190612793, Real Acc: 56.00000000000001, Fake Acc: 46.0
T, p_accept, rand, s_current, loss_curr 1.0 1 0.40014720735202947 [20880.698616107995, -0.054262252842899726, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124] 0.7238277
Finding most influential nodes in layer  8
<tensorflow.python.keras.layers.core.Dense object at 0x7f6e4f6a6e10>
Finding most influential nodes in layer  7
<tensorflow.python.keras.layers.core.Dense object at 0x7f6e4f6a6990>
Finding most influential nodes in layer  6
<tensorflow.python.keras.layers.core.Dense object at 0x7f6e4f6a6510>
768
{8: (0, array([0.20842493, 0.16435233, 0.07362828, 0.15391128], dtype=float32)), 7: (54, array([ 0.16109672, -0.04320148, -0.09356288,  0.09484137, -0.1199659 ,
        0.13744788, -0.07997745,  0.08954708, -0.11844751,  0.048196  ,
        0.04746132, -0.01592903, -0.04708327, -0.12281124,  0.08552785,
        0.02953605, -0.03998074,  0.13774201,  0.09102587, -0.15525268,
        0.02055731,  0.02273912, -0.06198462,  0.0829672 , -0.1085953 ,
        0.11792602,  0.11930348, -0.10741193,  0.03362127, -0.06025477,
        0.03871548,  0.12643284, -0.06302045, -0.09818706,  0.05006033,
        0.14081736, -0.06674462,  0.04209728, -0.08969892,  0.07521978,
        0.00291634,  0.03707656, -0.14154811,  0.04210107, -0.1186338 ,
       -0.04479832, -0.00579555, -0.11027398,  0.13479295,  0.03124712,
       -0.06082496, -0.14462097, -0.07524727,  0.12417474,  0.14304215,
       -0.07787032,  0.09800851, -0.11098688,  0.15206878, -0.0593623 ,
       -0.00405116, -0.04673663, -0.04361171, -0.03280756,  0.13355997,
        0.14375693,  0.07681511, -0.10708017, -0.14061743,  0.01011343,
        0.0362879 ,  0.05926788,  0.05773613, -0.10305314,  0.071629  ,
       -0.09742174, -0.12582324,  0.02808338, -0.13801847,  0.10519575,
        0.09376872, -0.04694675, -0.00064229, -0.0360113 , -0.0664488 ,
        0.14073254,  0.01426894, -0.08409157,  0.08589187,  0.05886345,
        0.05510899, -0.07031655,  0.13997312, -0.03583355,  0.01079742,
        0.08793632, -0.10665253, -0.05930921, -0.02014156, -0.02563496,
        0.15038723, -0.03944409, -0.07206386, -0.10151511, -0.05724949,
        0.00997753,  0.10724194,  0.00562256, -0.1233152 ,  0.0356943 ,
        0.09903779,  0.03416154, -0.15638454, -0.00948851,  0.05702239,
       -0.11434242, -0.03102875, -0.07555369, -0.05336173,  0.02912091,
       -0.11948827,  0.086904  ,  0.06903996, -0.04218798, -0.05358028,
       -0.00987766,  0.06636639,  0.08890352], dtype=float32)), 6: (32, array([-7.74199814e-02,  7.10277334e-02, -5.75205833e-02, -3.53542864e-02,
       -1.52233150e-02,  5.69184124e-02,  2.18603965e-02, -1.76329017e-02,
        2.55134422e-02,  4.02679443e-02, -2.89976061e-03, -3.87868807e-02,
       -8.57682377e-02,  2.05258862e-03, -3.06855086e-02,  1.14642158e-02,
       -7.31283659e-03, -6.39930367e-03, -8.04467686e-03,  3.34168994e-03,
       -4.98197041e-02, -4.22367826e-02, -6.49455469e-05, -6.13653138e-02,
        6.89483061e-02,  3.62238958e-02, -7.57470028e-04,  4.60542887e-02,
       -4.81466874e-02,  1.10604689e-02,  3.53642926e-02,  2.99200360e-02,
        4.36333716e-02, -1.14638507e-02, -4.78249379e-02,  6.89871460e-02,
        4.64712679e-02, -7.13638887e-02,  2.03780085e-02, -2.61270422e-02,
        6.45837635e-02, -3.47422436e-02, -7.74863958e-02, -5.06088547e-02,
        1.00559436e-01,  2.59010121e-03, -3.86965238e-02,  4.20926139e-02,
        5.45137282e-03,  8.25783331e-03, -2.86926720e-02, -1.03904186e-02,
        6.83409348e-02,  3.43193598e-02,  9.80661809e-02,  5.49540222e-02,
        4.41379510e-02, -7.75941536e-02, -1.02888113e-02, -6.29526749e-02,
        7.11243600e-02, -2.48452760e-02,  9.64770932e-03, -4.50576954e-02,
       -1.58944502e-02, -7.37497956e-02, -3.00883763e-02,  8.11716169e-02,
       -4.10083719e-02,  1.92961581e-02, -6.22865967e-02,  1.55484965e-02,
        9.97122657e-03,  6.28134757e-02,  4.33803834e-02,  5.39676473e-02,
       -7.45043857e-03,  4.18482274e-02,  5.36868982e-02,  1.27692707e-02,
        6.54756352e-02,  7.67253479e-03, -7.50781372e-02, -8.94213989e-02,
        6.00238629e-02, -4.24507372e-02,  8.45709965e-02,  7.68563300e-02,
       -7.17524290e-02, -6.20614402e-02,  5.67693338e-02,  5.75130899e-03,
       -1.02069182e-02, -3.17573659e-02,  4.53266017e-02,  1.58916041e-03,
        3.32273953e-02, -2.47548148e-02, -2.38627195e-03,  3.59473899e-02,
       -5.80866076e-02,  2.56174114e-02, -6.03229627e-02, -5.61294965e-02,
       -2.24601501e-03,  3.24503370e-02,  9.22384188e-02, -6.31824434e-02,
        6.84223175e-02, -4.11132090e-02, -6.68107495e-02, -3.49644646e-02,
        3.02515682e-02,  6.73952028e-02,  2.60262247e-02,  2.06125509e-02,
       -9.75687057e-02,  3.38463970e-02,  3.06692929e-03,  1.69509817e-02,
       -3.88384261e-03, -2.88015567e-02,  6.38174545e-03, -5.75011261e-02,
       -3.21927704e-02,  7.11079966e-03, -3.65476646e-02,  4.85511199e-02],
      dtype=float32))}
[[20880.698616107995, -0.06699029373674179, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124], [20880.698616107995, -0.054262252842899726, 25141.148256124518, 12682.350896772274, 12328.268186258403, 2216.116798093576, 1341.0223408700124]]
[0.8106005, 0.7238277]
